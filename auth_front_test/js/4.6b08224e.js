(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"flex column flex-center",staticStyle:{"font-size":"16px"}},[t.isLogined?s("div",{staticClass:"flex column flex-center",staticStyle:{"border-bottom":"1px solid grey",width:"300px",height:"200px"}},[s("div",{staticClass:"flex column justify-center items-center"},[s("p",[s("span",{staticClass:"text-grey"},[t._v("user:")]),t._v(" "+t._s(t.user))]),s("p",[s("span",{staticClass:"text-grey"},[t._v("position:")]),t._v(" "+t._s(t.position))])]),s("q-btn",{staticClass:"q-mt-md",attrs:{loading:t.loginLoading,color:"primary",label:"logout"},on:{click:t.logout}})],1):s("form",{staticClass:"flex column flex-center",staticStyle:{width:"300px"},attrs:{action:"#"}},[s("q-input",{staticStyle:{width:"100%"},attrs:{label:"login"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),s("q-input",{staticStyle:{width:"100%"},attrs:{label:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),s("q-btn",{staticClass:"q-mt-lg",attrs:{loading:t.loginLoading,disable:!t.username||!t.password,color:"primary",label:"submit"},on:{click:t.login}})],1),s("div",{staticClass:"q-mt-xl"},[s("q-btn",{attrs:{color:"accent",outline:"",label:"Check access",loading:t.secretLoading},on:{click:t.getSecret}})],1)])},i=[],a=(s("e6cf"),{name:"PageIndex",data(){return{loginLoading:!1,secretLoading:!1,isLogined:!1,username:"",password:"",token:"",user:"",position:""}},async created(){this.$q.loading.show(),localStorage.getItem("tandemToken")&&await this.getInfo(),this.$q.loading.hide()},methods:{async getInfo(){await this.$axios.get("/api/info").then((t=>{console.log("INFO: ",t),this.user=t.data.name,this.position=t.data.position,this.isLogined=!0})).catch((t=>{console.warn("INFO: ",t),this.loginLoading=!1}))},async login(){this.loginLoading=!0,await this.$axios.post("/api/login",{username:this.username,password:this.password}).then((async t=>{this.username="",this.password="",this.token=t.data.token,console.log("Ваш токен: ",this.token),console.log("Весь ответ сервера (LOGIN): ",t),localStorage.setItem("tandemToken",this.token),await this.getInfo(),this.loginLoading=!1,this.$q.notify({message:"Auth success",color:"positive",timeout:2e3})})).catch((t=>{console.warn("LOGIN: ",t),this.loginLoading=!1,this.$q.notify({message:"Auth error",color:"negative",timeout:2e3})}))},async logout(){this.loginLoading=!0,await this.$axios.get("/api/logout").then((t=>{localStorage.removeItem("tandemToken"),console.log("LOGOUT: ",t),this.loginLoading=!1,this.isLogined=!1,this.$q.notify({message:"Logout success",color:"positive",timeout:2e3})})).catch((t=>{console.warn("LOGOUT: ",t),this.loginLoading=!1,this.$q.notify({message:"Logout error",color:"negative",timeout:2e3})}))},async getSecret(){this.secretLoading=!0,await this.$axios.get("/api/secret").then((t=>{console.log("ACCESS: ",t),this.secretLoading=!1,this.$q.notify({message:"Access allowed",color:"positive",timeout:2e3})})).catch((t=>{console.warn("ACCESS: ",t),this.secretLoading=!1,t.response&&t.response.status?401==t.response.status?this.$q.notify({message:"No authorized",color:"negative",timeout:2e3}):403==t.response.status&&this.$q.notify({message:"Access denied",color:"negative",timeout:2e3}):this.$q.notify({message:"Something goes wrong",color:"negative",timeout:2e3})}))}}}),n=a,l=s("2877"),c=Object(l["a"])(n,o,i,!1,null,null,null);e["default"]=c.exports}}]);